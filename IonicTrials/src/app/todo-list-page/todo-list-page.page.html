<body>
  <ion-app>
    <ion-menu side="start" menuId="menu" content-id="main-content">
      <ion-header>
        <ion-toolbar translucent>
          <ion-title>{{ 'ToDoPage.todoDrawerTitle' | translate }}</ion-title>
        </ion-toolbar>
      </ion-header>
      <ion-content>
        <ion-list>
          <ion-item (click)="openMyDay()" [ngStyle]="selected==1?{'color': 'blue'} : {'color': 'grey'}">
            <ion-icon name="sunny-outline" slot="start" [ngStyle]="selected==1?{'color': 'blue'} : {'color': 'grey'}"></ion-icon>
            <ion-label>{{ 'ToDoPage.myDay' | translate }}</ion-label>
          </ion-item>
          <ion-item (click)="openImportant()" [ngStyle]="selected==2?{'color': 'magenta'} : {'color': 'grey'}">
            <ion-icon name="star-outline" slot="start" [ngStyle]="selected==2?{'color': 'magenta'} : {'color': 'grey'}"></ion-icon>
            <ion-label>{{ 'ToDoPage.important' | translate }}</ion-label>
          </ion-item>
          <ion-item (click)="openMyPlanned()" [ngStyle]="selected==3?{'color': 'orange'} : {'color': 'grey'}">
            <ion-icon name="planet-outline" slot="start" [ngStyle]="selected==3?{'color': 'orange'} : {'color': 'grey'}"></ion-icon>
            <ion-label>{{ 'ToDoPage.planned' | translate }}</ion-label>
          </ion-item>
          <ion-item (click)="openAssigned()" [ngStyle]="selected==4?{'color': 'green'} : {'color': 'grey'}">
            <ion-icon name="person-outline" slot="start" [ngStyle]="selected==4?{'color': 'green'} : {'color': 'grey'}"></ion-icon>
            <ion-label>{{ 'ToDoPage.assignToYou' | translate }}</ion-label>
          </ion-item>
          <ion-item (click)="openTasks()" [ngStyle]="selected==5?{'color': 'purple'} : {'color': 'grey'}">
            <ion-icon name="albums-outline" slot="start" [ngStyle]="selected==5?{'color': 'purple'} : {'color': 'grey'}"></ion-icon>
            <ion-label>{{ 'ToDoPage.tasks' | translate }}</ion-label>
          </ion-item>
          <li *ngFor="let todoType of todoTypesArray let i = index">
            <ion-item (click)="openCustomList(todoType)" [ngStyle]="selected==6+i?{'color': 'blue'} : {'color': 'grey'}">
              <ion-icon name="list-outline" slot="start" [ngStyle]="selected==6+i?{'color': 'blue'} : {'color': 'grey'}"></ion-icon>
              <ion-label>{{todoType.name}}</ion-label>
            </ion-item>
          </li>
          <ion-item (click)="createNewList()" [ngStyle]="{'color': 'black'}">
            <ion-icon name="add" slot="start" [ngStyle]="{'color': 'black'}"></ion-icon>
            <ion-label>{{ 'ToDoPage.createNewList' | translate }}</ion-label>
          </ion-item>
        </ion-list>
      </ion-content>
    </ion-menu>

    <div class="ion-page" id="main-content">
      <ion-header>
        <ion-toolbar>
          <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
          </ion-buttons>
          <ion-title>{{title}}</ion-title>
        </ion-toolbar>
      </ion-header>
    <div class="center" [hidden]="todoArray != null && todoArray.length > 0">
      <h4>{{ 'ToDoPage.tasksAppearHere' | translate }}</h4>
    </div>
      <ion-content class="ion-padding">
        <div [hidden]="todoArray == null || todoArray.length == 0" class="list-wrapper pt-1">
          <ul class="d-flex flex-column-reverse todo-list todo-list-custom" *ngFor="let todo of todoArray; let i = index">
            <li *ngIf="!todo.completed"  [ngClass]="{'completed' : todo.completed }">
              <div class="form-check form-check-flat col-md-12">
                <p><label class="form-check-label">
                  <input class=" checkbox" [checked]="todo.completed" type="checkbox" (change)="changeTodoStatus($event, i, todo)">
                  {{todo.task}}
                  <i class="input-helper"></i>
                </label></p>
                <label [ngStyle]="{'color': 'green'}" *ngIf="todo.dueDate != null">{{todo.dueDate | date: 'EEEE, MMM dd'}}</label>              
              </div>
              <button class="mr-2" (click)="impTodoItem(todo)" clear text-center>
                <ion-icon name="star-outline" *ngIf="!todo.important"></ion-icon>
                <ion-icon name="star" *ngIf="todo.important"></ion-icon>
             </button>
              <ionic-context-menu icon="ellipsis-vertical-outline">
                <ionic-context-menu-item icon="star-outline" (click)="impTodoItem(todo)">{{impText}}</ionic-context-menu-item>
                <ionic-context-menu-item icon="checkmark-done-outline" (click)="changeStatus(todo, true)">{{ 'ToDoPage.markCompleted' | translate }}</ionic-context-menu-item>
                <ionic-context-menu-item icon="today-outline" (click)="setDueDate(todo, 'today')">{{ 'ToDoPage.dueToday' | translate }}</ionic-context-menu-item>
                <ionic-context-menu-item icon="today-outline" (click)="setDueDate(todo, 'tomorrow')">{{ 'ToDoPage.dueTomorrow' | translate }}</ionic-context-menu-item>
                <ionic-context-menu-item icon="calendar-outline" (click)="selectCalendar(todo)">{{ 'ToDoPage.pickDueDate' | translate }}</ionic-context-menu-item>
                <ionic-context-menu-item icon="trash-outline" (click)="removeTodoItem(todo)">{{ 'ToDoPage.removeTask' | translate }}</ionic-context-menu-item>
              </ionic-context-menu>
            </li>
          </ul>
        </div>

        <div [hidden]="todoArray == null || todoArray.length == 0" class="faq-section mt-4">
          <ngb-accordion class="accordion" [closeOthers]="true" activeIds="panel-7">
            <ngb-panel id="panel-7" title="Completed Tasks">
              <ng-template ngbPanelContent>
                <div class="list-wrapper pt-1">
                  <ul class="d-flex flex-column-reverse todo-list todo-list-custom" *ngFor="let todo of todoArray; let i = index">
                    <li *ngIf="todo.completed" [ngClass]="{'completed' : todo.completed }">
                      <div class="form-check form-check-flat col-md-12">
                        <p><label class="form-check-label">
                          <input class="checkbox" [checked]="todo.completed" type="checkbox" (change)="changeTodoStatus($event, i)">
                          {{todo.task}}
                          <i class="input-helper"></i>
                        </label></p>
                        <label [ngStyle]="{'color': 'green'}" *ngIf="todo.dueDate != null">{{todo.dueDate | date: 'EEEE, MMM dd'}}</label> 
                      </div>
                      <button class="mr-2" (click)="impTodoItem(todo)" clear text-center>
                        <ion-icon name="star-outline" *ngIf="!todo.important"></ion-icon>
                        <ion-icon name="star" *ngIf="todo.important"></ion-icon>
                     </button>
                      <ionic-context-menu icon="ellipsis-vertical-outline">
                        <ionic-context-menu-item icon="star-outline" (click)="impTodoItem(todo)">{{impText}}</ionic-context-menu-item>
                        <ionic-context-menu-item icon="checkmark-done-outline" (click)="changeStatus(todo, false)">{{ 'ToDoPage.markNotCompleted' | translate }}</ionic-context-menu-item>
                        <ionic-context-menu-item icon="today-outline" (click)="setDueDate(todo, 'today')">{{ 'ToDoPage.dueToday' | translate }}</ionic-context-menu-item>
                        <ionic-context-menu-item icon="today-outline" (click)="setDueDate(todo, 'tomorrow')">{{ 'ToDoPage.dueTomorrow' | translate }}</ionic-context-menu-item>
                        <ionic-context-menu-item icon="calendar-outline" (click)="selectCalendar(todo)">{{ 'ToDoPage.pickDueDate' | translate }}</ionic-context-menu-item>
                        <ionic-context-menu-item icon="trash-outline" (click)="removeTodoItem(todo)">{{ 'ToDoPage.removeTask' | translate }}</ionic-context-menu-item>
                      </ionic-context-menu>
                    </li>
                  </ul>
                </div>
              </ng-template>
            </ngb-panel>
          </ngb-accordion>
        </div>
      </ion-content>

      <ion-card>  
        <ion-card-content>  
          <div class="row" [hidden]="selected==4">
            <div class="text-center col-md-12 ml-2">
            <form class="add-items d-flex mb-1" [formGroup]="form" (ngSubmit)="addTodo()">
              <input type="text" class="form-control todo-list-input" formControlName="todoitem" placeholder="Add a task">
              <button class="add btn btn-icon text-primary todo-list-add-btn bg-transparent mr-2" type="submit" [disabled]="form.invalid"><i class="ti-location-arrow"></i></button>
            </form>
            </div>
          </div>
        </ion-card-content>  
      </ion-card>  
    </div>
  </ion-app>
</body>